# error is that item is always inserted on the left, so it doesn't stay balanced

let t_gen a = Mu tt.
  if input == 123456789
  then ``Node {: v : a , l : tt , r : tt :}
  else ``Leaf {: leaf : bool :}
in

let t_check a = Mu tt.
  ( ``Node {: v : a , l : tt , r : tt :}
  || ``Leaf {: leaf : bool :}
  )
in

let rec size n = 
  match n with
  | `Leaf l -> 0
  | `Node node -> 1 + size node.l + size node.r
  end
in

let rec is_braun_tree x = 
  match x with
  | `Leaf l -> true
  | `Node node ->
    is_braun_tree node.l
    and is_braun_tree node.r
    and (size node.l == size node.r or size node.l == size node.r + 1)
  end
in

let bt_gen a = {. t_gen a | is_braun_tree } in
let bt_check a = {. t_check a | is_braun_tree } in

let rec insert (type a_) (tree : bt_gen a_) (x : a_) : bt_check a_ =
  match tree with
  | `Leaf l -> `Node { v = x , l = `Leaf { leaf = true } , r = `Leaf { leaf = true } }
  | `Node node ->
    `Node { l = insert a_ node.l x , r = node.r , v = node.v } # ERROR: only inserts to left, so won't be balanced
  end
in

insert