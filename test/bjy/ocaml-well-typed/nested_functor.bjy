(***
  (
    (features (Polymorphic_types Dependent_types Modules First_class_types Higher_order_functions))
    (speed Fast)
    (typing Well_typed)
    (flags "")
  )
*)

(*
  This is a well-typed test is adapted from ill-typed OCaml:
    testsuite/tests/typing-modules/functors.ml
*)

let M : sig
  val F : (X : (A : sig val xa : type end) -> (B : sig val xz : type end) -> sig end)
    -> (Y : (A : sig val ya : type end) -> (B : sig val yb : type end) -> sig end)
    -> (Z : (A : sig val za : type end) -> (B : sig val zb : type end) -> sig end)
    -> sig end
end = struct
  (* Note these don't need to be called dependent, but in the spirit of functors, we say they are *)
  let F
    (dependent X : (A : sig val xa : type end) -> (B : sig val xz : type end) -> sig end)
    (dependent Y : (A : sig val ya : type end) -> (B : sig val yb : type end) -> sig end)
    (dependent Z : (A : sig val za : type end) -> (B : sig val zb : type end) -> sig end)
    : sig end
    = struct end
end