(*** (
  (features (Variants Mu_types Higher_order_functions OOP_style Records Match))
) *)

let city = { population : int }

let shop = { inventory : int }

let sight = { is_open : bool }

let node_kind = `City of city | `Shop of shop | `Sight of sight

let node = Mu tt. ({ kind : node_kind ; neighbors : list tt })

let result_type = { result : int }

let visitor  =
  { visit_city : city -> result_type
  ; visit_shop : shop -> result_type
  ; visit_sight : sight -> result_type }

let visit (v : visitor) (start_node : node) : result_type =
  match start_node.kind with
  | `City c -> v.visit_city c
  | `Shop s -> v.visit_shop s
  | `Sight s -> v.visit_sight s
  end
