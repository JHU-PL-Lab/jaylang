Name: Odefa
Version: 0.2
Synopsis: An implementation of CBA analysis.
Authors: JHU PL Lab <pl.cs@jhu.edu>
License: BSD-4-clause

Description: An implementation of CBA analysis.
Homepage: http://www.big-bang-lang.org/

OASISFormat: 0.4
BuildTools: ocamlbuild
Plugins: META (0.4), DevFiles (0.4)
AlphaFeatures: ocamlbuild_more_args
XOCamlbuildExtraArgs: -use-menhir -use-ocamlfind

Library "utils"
  Path: src/utils
  Modules:
    Ast_uid,
    Dot_file_logger_utils,
    Dot_file_logger_utils_types,
    Logger_utils,
    Monad_utils,
    Multimap,
    Multimap_pp,
    Nondeterminism,
    Parser_support,
    Source_origin,
    String_utils,
    Utils
  BuildDepends:
    batteries,
    monadlib,
    ocaml-monadic

Library "ast"
  Path: src/ast
  Modules:
    Ast,
    Ast_pretty,
    Ast_tools,
    Ast_wellformedness
  BuildDepends:
    batteries,
    ppx_deriving.std,
    utils

Library "parser"
  Path: src/parser
  Modules:
    Generated_lexer,
    Generated_parser,
    Parser
  BuildDepends:
    batteries,
    ast,
    utils
  BuildTools+:
    ocamllex,
    menhir

Library "interpreter"
  Path: src/interpreter
  Modules:
    Interpreter
  BuildDepends:
    batteries,
    ast,
    utils

Library "nested-ast"
  Path: src/nested-ast
  Modules:
    Nested_ast
  BuildDepends:
    batteries,
    ast,
    utils

Library "nested-parser"
  Path: src/nested-parser
  Modules:
    Nested_generated_lexer,
    Nested_generated_parser,
    Nested_parser
  BuildDepends:
    batteries,
    nested-ast,
    utils
  BuildTools+:
    ocamllex,
    menhir
    
Library "a-translator"
  Path: src/a-translator
  Modules:
    A_translator
  BuildDepends:
    batteries,
    ast,
    nested-ast,
    utils
    
Library "pds-reachability"
  Path: src/pds-reachability
  Modules:
    Pds_reachability_analysis,
    Pds_reachability_basis,
    Pds_reachability_structure,
    Pds_reachability_types,
    Pds_reachability_types_stack,
    Pds_reachability
  BuildDepends:
    utils,
    batteries,
    ppx_deriving.std

Library "analysis"
  Path: src/analysis
  Modules:
    Analysis,
    Analysis_context_stack,
    Analysis_data_structures,
    Analysis_nonrepeating_stack,
    Analysis_single_element_stack,
    Analysis_two_element_stack,
    Analysis_unit_stack,
    Analysis_utils,
    Cba_graph,
    Cba_graph_logger,
    Cba_graph_logger_types
  BuildDepends:
    ast,
    pds-reachability,
    batteries,
    monadlib,
    ocaml-monadic (>= 0.3.1)

Library "toploop-utils"
  Path: src/toploop-utils
  Modules:
    Toploop_options
  BuildDepends:
    analysis,
    utils,
    batteries

Executable "toploop"
  Path: src/toploop
  MainIs: toploop.ml
  BuildDepends:
    ast,
    analysis,
    interpreter,
    parser,
    toploop-utils,
    batteries

Executable "nested-toploop"
  Path: src/nested-toploop
  MainIs: nested_toploop.ml
  BuildDepends:
    a-translator,
    ast,
    nested-ast,
    interpreter,
    nested-parser,
    toploop-utils,
    batteries

Executable "test"
  Path: test/
  MainIs: test.ml
  BuildDepends:
    utils,
    pds-reachability,
    interpreter,
    parser,
    ppx_deriving.std,
    oUnit,
    batteries

Test test
  Command: $test
